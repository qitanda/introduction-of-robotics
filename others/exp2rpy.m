function [theta1,theta2,theta3]=exp2rpy(ksi,theta)
w=ksi(1:3);
v=ksi(4:6);
w1=w(1,1);
w2=w(2,1);
w3=w(3,1);
w_m=[0 -w3 w2;...
     w3 0 -w1;...
     -w2 w1 0;];
R=[(w1^2)*(1-cosd(theta))+cosd(theta) w1*w2*(1-cosd(theta))-w3*sind(theta) w1*w3*(1-cosd(theta))+w2*sind(theta);...
    w1*w2*(1-cosd(theta))+w3*sind(theta) w2^2*(1-cosd(theta))+cosd(theta) w2*w3*(1-cosd(theta))-w1*sind(theta);...
    w1*w3*(1-cosd(theta))-w2*sind(theta) w2*w3*(1-cosd(theta))+w1*sind(theta) w3^2*(1-cosd(theta))+cosd(theta);];
I=[1 0 0;...
    0 1 0;...
    0 0 1;];
p=(I-R)*w_m*v+w*w.'*v*(theta/180)*pi;
T=[R p;...
    0 0 0 1;];
theta2 = atan2d(-T(3, 1), sqrt(T(3, 2)^2+T(3, 3)^2))
theta3 = atan2d(T(2, 1)/cosd(theta2), T(1, 1)/cosd(theta2))
theta1 = atan2d(T(3, 2)/cosd(theta2), T(3, 3)/cosd(theta2))
end